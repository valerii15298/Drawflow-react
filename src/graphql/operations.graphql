fragment nodeInfo on NodeInfo {
  name
  description
  type
  iconLink
}

fragment NodeSwitchProps on NodeSwitchProps {
  displayType
}

fragment NodeFileProps on NodeFileProps {
  info
  url
}

fragment NodeSwitchOptionProps on NodeSwitchOptionProps {
  imageLink
  text
}

fragment NodeLinkProps on NodeLinkProps {
  src
  text
}

fragment NodeAudioProps on NodeAudioProps {
  src
}

fragment NodeImageProps on NodeImageProps {
  src
}

fragment NodeTextProps on NodeTextProps {
  src
}

fragment NodeVideoProps on NodeVideoProps {
  src
}

fragment NodeWaitProps on NodeWaitProps {
  src
  delay
}

fragment NodeCountdownProps on NodeCountdownProps {
  duration
}

fragment nodeProps on NodeProps {
  ...NodeFileProps
  ...NodeLinkProps
  ...NodeSwitchOptionProps
  ...NodeImageProps
  ...NodeCountdownProps
  ...NodeAudioProps
  ...NodeSwitchProps
  ...NodeVideoProps
  ...NodeTextProps
  ...NodeWaitProps
}

fragment templateNode on TemplateNode {
  id
  order
  group {
    id
  }
  info {
    ...nodeInfo
  }
  props {
    ...nodeProps
  }
}

query templateNodes($filter: TemplateNodeFilter) {
  queryTemplateNode(filter: $filter) {
    ...templateNode
  }
}

mutation templateNodesMutation($input: [AddTemplateNodeInput!]!) {
  addTemplateNode(input: $input) {
    templateNode {
      id
    }
  }
}

mutation templateNodesUpdate($input: UpdateTemplateNodeInput!) {
  updateTemplateNode(input: $input) {
    templateNode {
      id
    }
  }
}

mutation templateNodesDelete($filter: TemplateNodeFilter!) {
  deleteTemplateNode(filter: $filter) {
    templateNode {
      id
    }
  }
}

query templateNodesGroups {
  queryTemplateNodesGroup {
    id
    name
    description
  }
}

mutation templateNodesGroupsMutation($input: [AddTemplateNodesGroupInput!]!) {
  addTemplateNodesGroup(input: $input) {
    templateNodesGroup {
      id
    }
  }
}

mutation templateNodesGroupsUpdate($input: UpdateTemplateNodesGroupInput!) {
  updateTemplateNodesGroup(input: $input) {
    templateNodesGroup {
      id
    }
  }
}

mutation templateNodesGroupsDelete($filter: TemplateNodesGroupFilter!) {
  deleteTemplateNodesGroup(filter: $filter) {
    templateNodesGroup {
      id
    }
  }
}

query botFlow($id: ID!) {
  getBotFlow(id: $id) {
    name
    description
    nextVersionNumber
    versions {
      nodes {
        id
        props {
          ...nodeProps
        }
        info {
          ...nodeInfo
        }
        pos {
          x
          y
        }
        ports {
          index
          pos {
            x
            y
          }
        }
      }
      connections {
        from {
          id
        }
        to {
          id
        }
      }
    }
  }
}

mutation botFlowVersion($flow: [AddBotFlowVersionInput!]!) {
  addBotFlowVersion(input: $flow) {
    botFlowVersion {
      id
    }
  }
}
