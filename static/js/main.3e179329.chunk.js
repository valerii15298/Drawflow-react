(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{39:function(t,e,n){},40:function(t,e,n){"use strict";n.r(e);var o,i,r=n(0),c=n.n(r),a=n(16),s=n.n(a),u=n(4),l=n(2),d=n(6),f=n(5),h=function(){var t=document.querySelector(".drawflow"),e=t.getBoundingClientRect();return{x:e.x,y:e.y,width:t.clientWidth,height:t.clientHeight}},p={createCurvature:function(t,e){var n=(t.y-e.y)/2,o=t.x-e.x;return"M ".concat(t.x," ").concat(t.y," v ").concat(-n," h ").concat(-o," v ").concat(-n," ")},getCanvasInfo:h,getPos:function(t,e,n){var o=h(),i=o.x,r=o.y,c=o.width,a=o.height;return{x:t*(c/(c*n))-i*(c/(c*n)),y:e*(a/(a*n))-r*(a/(a*n))}},findIndexByElement:function(t){for(var e=t.parentElement,n=Array.from(e.childNodes),o=0;o<n.length;o++)if(n[o]===t)return o;return-1},getPortPosWithZoom:function(t,e,n){var o=p.getCanvasInfo(),i=1/n;return{x:t.width/2+(e.x-o.x)*i,y:t.height/2+(e.y-o.y)*i}}},b=p;!function(t){t.START="START",t.MIDDLE="MIDDLE",t.END="END"}(o||(o={})),function(t){t.Drawflow="drawflow"}(i||(i={}));var v,g;!function(t){t.NODE_SETTINGS="NODE_SETTINGS",t.GROUP_SETTINGS="GROUP_SETTINGS"}(v||(v={})),function(t){t.in="in",t.out="out"}(g||(g={}));var j,y,O,x,w,m,k,S,I,N,C,P,_,D,T,E,M,W,X,L,Y,z=n(8),V=n(17),A=n(18),B=n(19),U=n(22),F=n.n(U),K={width:100,height:60},G=function(){function t(e,n){Object(A.a)(this,t),this.id=void 0,this.state=void 0,this.flow=void 0,this.nodeState=void 0,this.spacingX=40,this.spacingY=60,this.id=e,this.flow=n,this.state=n.state,this.nodeState=this.state.drawflow[this.id]}return Object(B.a)(t,[{key:"head",get:function(){return this.nodeState.head}},{key:"lane",get:function(){return this.nodeState.lane}},{key:"port",get:function(){return this.nodeState.port}},{key:"portInPos",get:function(){var t,e=this;return null===(t=Object.entries(this.state.ports).find((function(t){var n=Object(u.a)(t,2),o=n[0];n[1];return o==="".concat(e.id,"_in_1")})))||void 0===t?void 0:t[1]}},{key:"outPorts",get:function(){var t=this;return Object.entries(this.state.ports).filter((function(e){var n=Object(u.a)(e,2),o=n[0];n[1];return o.startsWith("".concat(t.id,"_out"))}))}},{key:"parent",get:function(){var t,e=this,n=null===(t=Object.keys(this.state.connections).find((function(t){return t.split("_")[2]===e.id.toString()})))||void 0===t?void 0:t.split("_")[0];return n?this.flow.getNode(Number(n)):null}},{key:"parentConnection",get:function(){var t=this;return Object.keys(this.state.connections).find((function(e){var n,o=e.split("_").map(Number);return o[0]===(null===(n=t.parent)||void 0===n?void 0:n.id)&&o[2]===t.id&&1===o[3]}))}},{key:"totalWidth",get:function(){return!1===this.nodeState.visible?0:Math.max(this.width+this.subnodesWidth,this.leftWidth+this.rightWidth)}},{key:"childrenTotalWidth",get:function(){var t=this.out1;if(!t.length)return 0;var e=0;return t.forEach((function(t){e+=t.totalWidth})),e+this.spacingX*(t.length-1)}},{key:"alignChildren",value:function(){var t=this,e=this.out1;this.update({isSub:!1,port:{out:2}});var n,o=this.pos.x-(this.leftWidth-this.width/2),i=Object(V.a)(e);try{for(i.s();!(n=i.n()).done;){var r=n.value,c=o+(r.leftWidth-r.width/2);r.setPos({x:c,y:this.pos.y+this.height+this.spacingY}),!1!==r.nodeState.visible&&(o+=r.totalWidth+this.spacingX),r.alignChildren()}}catch(s){i.e(s)}finally{i.f()}var a=this.subnodes;a.length&&(o=this.pos.x+this.width+this.spacingX,a.forEach((function(e){e.update(Object(d.a)({isSub:!0,port:{out:1}},K)),e.setPos({x:o,y:t.pos.y+(t.height/2-e.height/2)}),delete t.state.ports["".concat(e.id,"_out_2")],o+=e.width+t.spacingX})))}},{key:"leftWidth",get:function(){if(!1===this.nodeState.visible)return 0;var t=this.out1,e=this.childrenTotalWidth,n=this.width/2;if(!t.length)return n;var o=t[0].leftWidth,i=o+(e-o-t[t.length-1].rightWidth)/2;return Math.max(i,n)}},{key:"rightWidth",get:function(){if(!1===this.nodeState.visible)return 0;var t=this.out1,e=this.childrenTotalWidth,n=this.width/2+this.subnodesWidth;if(!t.length)return n;var o=t[0].leftWidth,i=t[t.length-1].rightWidth,r=i+(e-o-i)/2;return Math.max(r,n)}},{key:"all2Successors",get:function(){var t=this.subnodes,e=this.out1,n=Object(z.a)(e);return t.forEach((function(t){return n.push(t)})),this.out1.forEach((function(t){return n.push(t)})),n}},{key:"allSuccessors",get:function(){var t=[].concat(Object(z.a)(this.out1),Object(z.a)(this.subnodes)),e=Object(z.a)(t);return t.forEach((function(t){return e.push.apply(e,Object(z.a)(t.allSuccessors))})),e}},{key:"toggleVisibility",value:function(t){var e=this;this.update({visible:t}),this.parentConnection&&(this.state.connections[this.parentConnection]=t),this.outConnections.forEach((function(n){e.state.connections[n]=t}))}},{key:"toggleChildrenVisibility",value:function(){var t,e=null===(t=this.nodeState.childrenVisibility)||void 0===t||t;this.update({childrenVisibility:!e});var n=this.subnodes;this.allSuccessors.forEach((function(t){n.includes(t)||t.toggleVisibility(!e)}))}},{key:"toggleSubnodesVisibility",value:function(){var t,e=null===(t=this.nodeState.subnodesVisibility)||void 0===t||t;this.update({subnodesVisibility:!e}),this.subnodes.forEach((function(t){t.toggleVisibility(!e)}))}},{key:"outConnections",get:function(){var t=this;return Object.entries(this.state.connections).filter((function(e){return Object(u.a)(e,1)[0].split("_").map(Number)[0]===t.id})).map((function(t){return t[0]}))}},{key:"children",value:function(t){var e=this;return Object.keys(this.state.connections).filter((function(n){return n.split("_")[0]===e.id.toString()&&n.split("_")[1]===t.toString()})).map((function(t){return e.flow.getNode(Number(t.split("_")[2]))}))}},{key:"out1",get:function(){return this.children(1)}},{key:"firstSubnode",get:function(){return this.children(2)[0]}},{key:"subnodes",get:function(){var t,e;return(null===(t=this.firstSubnode)||void 0===t||null===(e=t.flowLine)||void 0===e?void 0:e.flowLineNodes)||[]}},{key:"subnodesWidth",get:function(){var t=this;return this.subnodes.reduce((function(e,n){return e+n.width+t.spacingX}),0)}},{key:"isSub",get:function(){return null!==this.complexParentNode}},{key:"complexParentNode",get:function(){var t=this.parent;return t?t.firstSubnode===this?t:t.complexParentNode:null}},{key:"flowLine",get:function(){for(var t=[this],e=this,n=e.firstSubnode;1===e.out1.length;)n=n||e.firstSubnode,e=e.out1[0],t.push(e);return e.out1.length>1?null:{flowLineNodes:t,hasSubnodes:n}}},{key:"height",get:function(){return this.state.drawflow[this.id].height}},{key:"width",get:function(){return this.state.drawflow[this.id].width}},{key:"pos",get:function(){return this.state.drawflow[this.id].pos}},{key:"setPos",value:function(t){var e=this.pos,n=t.x,o=t.y;this.flow.moveNode({nodeId:this.id,dx:n-e.x,dy:o-e.y})}},{key:"update",value:function(t){var e=F.a.merge(this.nodeState,t);Object.assign(this.nodeState,e)}}]),t}(),J=function(){function t(e){var n=this;Object(A.a)(this,t),this.state=void 0,this.nodes={},this.distanceToConnect=100,this.distanceToDisconnect=0,this.state=e;var o=this.state.drawflow;Object.keys(o).map((function(t){return n.nodes[Number(t)]=new G(Number(t),n)}))}return Object(B.a)(t,[{key:"heads",get:function(){return Object.entries(this.nodes).filter((function(t){var e=Object(u.a)(t,2);e[0];return!e[1].parent})).map((function(t){return t[1]}))}},{key:"getNode",value:function(t){return this.nodes[t]}},{key:"alignAll",value:function(){this.setLaneNumbers(),this.heads.forEach((function(t){t.alignChildren()}))}},{key:"allowConnection",value:function(t){var e=t.startId,n=t.startPort,o=t.endId,i=this.getNode(o),r=this.getNode(e),c=2===n;if(i.parent||!1===r.nodeState.visible)return!1;var a=i.flowLine;return!((c||r.isSub)&&(!a||a.hasSubnodes))}},{key:"addConnection",value:function(t){var e=t.startId,n=t.startPort,o=t.endId,i=t.endPort,r=this.getNode(o),c=this.getNode(e),a=2===n;if(r.parent||!1===c.nodeState.visible)return!1;var s=r.flowLine;if((a||c.isSub)&&(!s||s.hasSubnodes))return!1;var u=null;if(a&&c.subnodes.length){if(!1===c.nodeState.subnodesVisibility){e=c.subnodes[c.subnodes.length-1].id,n=1;var l="".concat(e,"_").concat(n,"_").concat(o,"_").concat(i);return this.state.connections[l]=!0,void s.flowLineNodes.forEach((function(t){return t.toggleVisibility(!1)}))}u=c.subnodes[0]}if(c.isSub&&c.out1.length&&(u=c.out1[0]),null!==u){var d="".concat(e,"_").concat(n,"_").concat(u.id,"_1");delete this.state.connections[d];var f=s.flowLineNodes,h=f[f.length-1],p="".concat(h.id,"_1_").concat(u.id,"_1");this.state.connections[p]=!0}var b="".concat(e,"_").concat(n,"_").concat(o,"_").concat(i);this.state.connections[b]=!0}},{key:"moveNode",value:function(t){var e=t.dx,n=t.dy,o=t.nodeId;this.state.drawflow[o].pos.x+=e,this.state.drawflow[o].pos.y+=n}},{key:"dragNode",value:function(t){var e=t.dx,n=t.dy,o=t.nodeId;this.moveNode({dx:e,dy:n,nodeId:o});var i=this.getNode(o),r=i.head;i.parentConnection&&(delete this.state.connections[i.parentConnection],this.alignAll());var c=i.portInPos;if(c){var a=[];if(Object.entries(this.nodes).filter((function(t){var e=Object(u.a)(t,2);e[0];return e[1].head!==r})).forEach((function(t){var e=Object(u.a)(t,2),n=e[0],i=e[1];Number(n)!==o&&i.outPorts.forEach((function(t){var e=Object(u.a)(t,2),n=e[0],o=e[1],i=Math.hypot(c.x-o.x,c.y-o.y);a.push({key:n,distance:i})}))})),a.sort((function(t,e){return t.distance-e.distance})),a.length){var s=a.shift();s.distance<this.distanceToConnect?this.state.portToConnect=s.key:this.state.portToConnect=void 0}}}},{key:"setLaneNumbers",value:function(){var t=this,e=this.heads;e.forEach((function(t){return t.update({head:t.id,lane:0})}));for(var n=function(){var t=[];e.forEach((function(e){var n=e.lane+1,o=e.subnodes,i=e.head;if(void 0!==i){if(o.length){var r,c=Object(V.a)(o);try{for(c.s();!(r=c.n()).done;){r.value.update({lane:n++,head:i})}}catch(s){c.e(s)}finally{c.f()}}var a=e.children(1);a.forEach((function(t){return t.update({head:i,lane:n})})),t.push.apply(t,Object(z.a)(a))}else console.error("head is undefined in setLaneNumbers")})),e=t};e.length;)n();this.heads.forEach((function(e){for(var n=e.head,o=function(e,o,i){(i=Object.values(t.nodes).filter((function(t){return t.lane===e&&t.head===n}))).forEach((function(t){t.update({positionNumber:o++})})),r=o,c=i},i=0,r=0,c=[e];c.length;++i)o(i,r,c)}))}}]),t}(),R={nodeId:1,canvasDrag:!1,config:{drag:!1,connectionsLabelEnable:!1,canvasTranslate:{x:0,y:0},zoom:{value:1,max:2,min:.5,tick:.1}},drawflow:{},connections:{},connectionsLabel:{},ports:{},select:null,selectId:null,selectPath:null,showButton:null,newPathDirection:null,modalType:null,editLock:!1,mouseBlockDragPos:{clientX:void 0,clientY:void 0}},q=function(t){new J(t).alignAll()},H=Object(f.f)({name:i.Drawflow,initialState:R,reducers:{setEditLock:function(t,e){var n=e.payload;t.editLock=n},align:q,moveNode:function(t,e){return new J(t).dragNode(e.payload)},setMouseBlockDragPos:function(t,e){var n=e.payload;t.mouseBlockDragPos=n},unSelect:function(t){t.config.drag=!1,t.select=null,t.selectId=null,t.showButton=null},select:function(t,e){var n=e.payload,o=n.type,i=n.selectId;t.config.drag="node"===o,t.select=n,t.selectId=null!==i&&void 0!==i?i:null},moveCanvas:function(t,e){var n=e.payload,o=n.movementX,i=n.movementY;t.canvasDrag&&(t.config.canvasTranslate.x+=o,t.config.canvasTranslate.y+=i)},canvasDrag:function(t,e){var n=e.payload;t.canvasDrag=n},canvasMouseMove:function(t,e){var n,o=e.payload,i=o.movementX,r=o.movementY,c=o.clientX,a=o.clientY;if(t.clientCurrentMousePos={clientX:c,clientY:a},t.canvasDrag)t.config.canvasTranslate.x+=i,t.config.canvasTranslate.y+=r;else if((null===(n=t.select)||void 0===n?void 0:n.type)===g.out)t.newPathDirection={clientX:c,clientY:a};else if(t.config.drag&&"number"===typeof t.selectId){var s=t.selectId,u=t.mouseBlockDragPos,l=u.clientX,d=u.clientY;t.mouseBlockDragPos={clientX:c,clientY:a};var f=t.config.zoom.value,h=(c-l)/f,p=(a-d)/f;new J(t).dragNode({nodeId:s,dy:p,dx:h})}},canvasMouseUp:function(t){var e,n=new J(t);if(t.portToConnect){var o=t.portToConnect.split("_").map((function(t){return Number(t)})),i=Object(u.a)(o,3),r=i[0],c=i[2],a=Number(t.selectId);n.addConnection({startId:r,startPort:c,endId:a,endPort:1})}t.portToConnect=void 0,t.newPathDirection=null,t.canvasDrag=!1,t.config.drag=!1,(null===(e=t.select)||void 0===e?void 0:e.type)===g.out&&(t.select=null),n.alignAll()},deleteNode:function(t){var e=t.connections,n=t.drawflow,o=t.ports,i=t.selectId,r=t.select;i&&"number"===typeof i&&"node"===(null===r||void 0===r?void 0:r.type)&&(Object.keys(e).reduce((function(t,n){var o=n.split("_").map((function(t){return parseInt(t)}));return 1*o[0]!==i&&1*o[2]!==i||delete e[n],null}),null),Object.keys(o).reduce((function(t,e){return 1*e.split("_").map((function(t){return parseInt(t)}))[0]===i&&delete o[e],null}),null),delete n[i],t.select=null,t.selectId=null,t.showButton=null)},deletePath:function(t){var e=t.selectId,n=t.connections,o=t.select;"string"===typeof e&&"path"===(null===o||void 0===o?void 0:o.type)&&delete n[e]},load:function(t,e){var n=e.payload;return Object.assign(t,R),t.drawflow=n.drawflow,t.nodeId=Object.keys(n.drawflow).length+1,t.connections=n.connections,t},portMouseUp:function(t,e){var n=e.payload,o=n.nodeId,i=n.portId,r=n.PortType,c=t.selectId,a=t.select;if(r===g.in&&"number"===typeof c&&(null===a||void 0===a?void 0:a.portId)){var s=o,u=i,l=c,d=a.portId;if(l!==s)new J(t).addConnection({startId:l,startPort:d,endId:s,endPort:u})}},clear:function(){return R},pushPorts:function(t,e){var n=e.payload;t.ports=Object(d.a)(Object(d.a)({},t.ports),n)},zoom:function(t,e){var n=e.payload,o=t.config.zoom,i=o.value,r=o.max,c=o.min,a=o.tick,s=i+(n?a:-a);s<=r&&s>=c&&(o.value=s),null===n&&(t.config.canvasTranslate={x:0,y:0},o.value=1)},nodeSize:function(t,e){var n=e.payload,o=n.height,i=n.width,r=n.id;t.drawflow[r].height=o,t.drawflow[r].width=i},toggleSubnodes:function(t,e){var n=e.payload.id;new J(t).getNode(n).toggleSubnodesVisibility(),q(t)},toggleChildren:function(t,e){var n=e.payload.id;new J(t).getNode(n).toggleChildrenVisibility(),q(t)},copyNode:function(t){var e;"node"===(null===(e=t.select)||void 0===e?void 0:e.type)&&"number"===typeof t.select.selectId&&(t.nodeToCopyId=t.select.selectId)},insertCopiedNode:function(t){if(void 0!==t.nodeToCopyId){var e=t.clientCurrentMousePos,n=e.clientX,o=e.clientY,i=JSON.parse(JSON.stringify(t.drawflow[t.nodeToCopyId]));i.pos=b.getPos(n,o,t.config.zoom.value),t.drawflow[t.nodeId]=Object(d.a)(Object(d.a)({},i),{},{id:t.nodeId,height:0,width:0}),++t.nodeId}}}}),Z=H.actions,Q=H.reducer,$=function(t){return t.flows[t.version]},tt=n(15),et=function(){return Object(tt.b)()},nt=tt.c,ot=n(7),it=n.n(ot),rt=n(10),ct=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,i=[],r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;c<t;c++){for(var a="",s=0;s<Math.floor(Math.random()*(n-o)+o);s++)a+=r.charAt(Math.floor(Math.random()*r.length));e.length>1&&(a+=e),i.push(a)}return i},at=function(){var t=Object(rt.a)(it.a.mark((function t(e){var n,o,i;return it.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=function(){return{type:"Asd",name:"assa",value:ct(1,"",10,5)[0]}},o=[],i=0;i<e;++i)o.push(n());return t.abrupt("return",o);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),st=function(){return{id:0,type:o.MIDDLE,data:{type:"Node type",name:"Node name",value:"Node value"},port:{in:1,out:2},pos:{x:-20,y:100},isSub:!1,height:0,width:0}},ut={getDummy:function(){var t=Object(rt.a)(it.a.mark((function t(){var e,n,o;return it.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e={nodes:{},connections:{"1_1_3_1":!0,"4_1_2_1":!0}},n=1;n<5;++n)(o=st()).id=n,o.data.name="Node ".concat(n),o.pos.x=100*n,o.pos.y=50*n,e.nodes[n]=o;return t.abrupt("return",e);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),getFilters:at},lt=Object(f.b)("versions/changed"),dt=Object(f.b)("addNewNode"),ft=Object(f.b)("dragTemplate"),ht={version:0,flows:[R,R,R],templates:[],dragTemplate:0},pt=Object(f.c)("fetchPosts",Object(rt.a)(it.a.mark((function t(){var e;return it.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ut.getFilters(5);case 2:return e=t.sent,console.log(e),t.abrupt("return",e);case 5:case"end":return t.stop()}}),t)})))),bt=Object(f.c)("fetchFlowVersion",Object(rt.a)(it.a.mark((function t(){return it.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ut.getDummy();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))),vt=Object(f.e)(ht,(function(t){t.addCase(lt,(function(t,e){var n=e.payload;t.version=n})).addCase(dt,(function(t,e){var n=e.payload,o=n.clientX,i=n.clientY;if(t.dragTemplate){var r=t.flows[t.version],c=st();c.pos=b.getPos(o,i,r.config.zoom.value),r.mouseBlockDragPos={clientX:o,clientY:i},r.drawflow[r.nodeId]=Object(d.a)(Object(d.a)({},c),{},{id:r.nodeId,height:0,width:0}),r.selectId=r.nodeId++,r.select={type:"node",selectId:r.selectId},r.config.drag=!0,t.dragTemplate=void 0}})).addCase(ft,(function(t,e){var n=e.payload;t.dragTemplate=n})).addCase(pt.fulfilled,(function(t,e){t.templates=e.payload})).addCase(bt.fulfilled,(function(t,e){var n=e.payload,o=n.nodes,r=n.connections;t.flows[t.version]=Q(t.flows[t.version],{type:i.Drawflow+"/load",payload:{drawflow:o,connections:r}})})).addMatcher((function(t){return t.type.startsWith(i.Drawflow)}),(function(t,e){t.flows[t.version]=Q(t.flows[t.version],e)}))})),gt=Object(f.a)({reducer:vt}),jt=n(3),yt=n(1),Ot=jt.b.div(j||(j=Object(l.a)(["\n  position: absolute;\n  top: 10px;\n  right: 10px;\n  padding: 5px 10px;\n  background-color: #ddd;\n  font-weight: bold;\n  z-index: 1;\n"]))),xt=jt.b.button(y||(y=Object(l.a)(["\n  background-color: #333;\n  color: #fff;\n  border-radius: 4px;\n"]))),wt=function(){var t=nt((function(t){return $(t).editLock})),e=et();return Object(yt.jsxs)(Ot,{children:[!t&&Object(yt.jsx)(xt,{children:"Clear"}),Object(yt.jsx)(xt,{onClick:function(){return e(Z.setEditLock(!t))},children:t?"UnLock":"Lock"})]})},mt=jt.b.div(O||(O=Object(l.a)(["\n  position: absolute;\n  bottom: 10px;\n  right: 10px;\n  padding: 5px 10px;\n  background-color: #ddd;\n  font-weight: bold;\n  z-index: 1;\n"]))),kt=jt.b.button(x||(x=Object(l.a)(["\n  background-color: #333;\n  color: #fff;\n  border-radius: 4px;\n  padding: 3px 10px;\n"]))),St=function(){var t=et();return Object(yt.jsxs)(mt,{children:[Object(yt.jsx)(kt,{onClick:function(){return t(Z.zoom(!0))},children:"+"}),Object(yt.jsx)(kt,{onClick:function(){return t(Z.zoom(!1))},children:"-"}),Object(yt.jsx)(kt,{onClick:function(){return t(Z.zoom(null))},children:"reset"})]})},It=function(t){var e=t.property,n=t.svgKey,o=t.i,i=t.editLock;return Object(yt.jsx)("circle",Object(d.a)(Object(d.a)({},e),{},{r:6,onMouseDown:function(e){i||t.select(e,{svgKey:n,i:o})}}))},Nt=jt.b.svg(w||(w=Object(l.a)(["\n  position: absolute;\n  overflow: visible;\n"]))),Ct=jt.b.path(m||(m=Object(l.a)(["\n  :hover {\n    stroke-width: 6px;\n    stroke: purple;\n    cursor: pointer;\n  }\n  fill: none;\n  stroke-width: ","px;\n  stroke: steelblue;\n"])),(function(t){return t.theme.selected?7:6})),Pt={Circle:It,Path:function(t){var e=t.svgKey,n=t.d,o=nt($).selectId,i=et();return Object(yt.jsx)(Nt,{children:Object(yt.jsx)(Ct,{theme:{selected:o===e&&e},d:n,onMouseDown:function(t){e&&(t.stopPropagation(),i(Z.select({type:"path",selectId:e})))}})})}},_t=function(){var t=nt($),e=t.select,n=t.config,o=t.ports,i=t.selectId,r=t.newPathDirection;if(!(null===e||void 0===e?void 0:e.portId))return console.error("Select port id not set!"),null;var c="".concat(i,"_out_").concat(e.portId);if(!o[c])return console.error("Start port key not exist"),null;if(!r)return console.error("Path direction null"),null;var a={x:o[c].x,y:o[c].y},s=n.zoom.value,u=r.clientX,l=r.clientY,d=b.getPos(u,l,s),f=b.createCurvature(a,d);return Object(yt.jsx)(Pt.Path,{d:f})},Dt=n(9),Tt=jt.b.div(k||(k=Object(l.a)(["\n  max-height: 100%;\n  overflow: hidden;\n"]))),Et=function(t){return Object(yt.jsx)(Tt,{children:JSON.stringify(t,null,2)})},Mt=jt.b.div(S||(S=Object(l.a)(["\n  width: 15px;\n  height: 15px;\n  border-radius: 60px;\n  background-color: #217ce8;\n  opacity: ",";\n  transform: scale(",");\n  transition: all 0.3s cubic-bezier(0.05, 0.03, 0.35, 1);\n"])),(function(t){return t.visible?1:0}),(function(t){return t.visible?1:0})),Wt=jt.b.div(I||(I=Object(l.a)(["\n  height: 15px;\n  width: 15px;\n  border-radius: 50%;\n  background-color: red;\n  position: absolute;\n"]))),Xt=Object(jt.b)(Wt)(N||(N=Object(l.a)(["\n  left: 50%;\n  top: 100%;\n  transform: translate(-50%, -50%);\n  ","\n"])),(function(t){return t.isSub&&Object(jt.a)(C||(C=Object(l.a)(["\n      left: 100%;\n      top: 50%;\n    "])))})),Lt=Object(jt.b)(Wt)(P||(P=Object(l.a)(["\n  left: 100%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  ","\n"])),(function(t){return t.isSub&&Object(jt.a)(_||(_=Object(l.a)(["\n      display: none;\n    "])))})),Yt=Object(jt.b)(Wt)(D||(D=Object(l.a)(["\n  left: 50%;\n  top: 0;\n  transform: translate(-50%, -50%);\n\n  ","\n"])),(function(t){return t.isSub&&Object(jt.a)(T||(T=Object(l.a)(["\n      left: 0;\n      top: 50%;\n    "])))})),zt=(E={},Object(Dt.a)(E,g.in,[Yt]),Object(Dt.a)(E,g.out,[Xt,Lt]),E),Vt=Object(f.d)($,(function(t){return t.portToConnect})),At=function(t){for(var e=t.id,n=t.port,o=t.type,i=et(),r=nt(Vt),c=nt(function(t){return Object(f.d)($,(function(e){return e.drawflow[t].isSub}))}(e)),a=[],s=function(t){var n="".concat(o,"put-").concat(t),s="".concat(e,"_").concat(o,"_").concat(t),u=zt[o][t-1],l=Object(yt.jsx)(u,{isSub:c,onMouseDown:function(n){n.stopPropagation(),i(Z.select({type:o,portId:t,selectId:e}))},onMouseUp:function(n){i(Z.portMouseUp({nodeId:e,portId:t,PortType:o}))},children:Object(yt.jsx)(Mt,{visible:!(r!==s)})},n);a.push(l)},u=1;u<=n[o];u++)s(u);return Object(yt.jsx)("div",{className:"".concat(o,"puts"),children:a})},Bt=jt.b.div(M||(M=Object(l.a)(["\n  display: inline-block;\n  position: absolute;\n  padding: 5px;\n  width: 200px;\n  min-height: 60px;\n  background-color: #d3d3d3;\n  z-index: 1;\n  cursor: move;\n  top: ","px;\n  left: ","px;\n\n  ","\n  ",";\n"])),(function(t){return t.y}),(function(t){return t.x}),(function(t){return t.isSub&&Object(jt.a)(W||(W=Object(l.a)(["\n      height: ","px;\n      width: ","px;\n    "])),K.height,K.width)}),(function(t){return t.selected&&Object(jt.a)(X||(X=Object(l.a)(["\n      box-shadow: 0 2px 15px 2px #cacaca;\n      z-index: 2;\n    "])))})),Ut=function(t){var e=t.id,n=nt($),o=n.nodeId,i=n.config.drag,c=n.drawflow[e],a=nt(function(t){return Object(f.d)($,(function(e){var n=e.selectId;return t===n}))}(e)),s=et(),u=c.port,l=c.pos,h=Object(r.useRef)(null);return Object(r.useEffect)((function(){if(h.current){var t=h.current,n=t.offsetHeight,o=t.offsetWidth;s(Z.nodeSize({height:n,width:o,id:e}))}}),[s,e,c]),Object(r.useEffect)((function(){var t=function(t,n,o){var i="".concat(e,"_").concat(t,"_").concat(n),r=parseInt(getComputedStyle(o).left)+c.pos.x,a=parseInt(getComputedStyle(o).top)+c.pos.y;return Object(Dt.a)({},i,{x:r,y:a})};if(h.current){var n=Array.from(h.current.querySelector(".inputs").children),o=Array.from(h.current.querySelector(".outputs").children),i={};i=Object.assign(i,n.reduce((function(e,n,o){return Object.assign(e,t(g.in,o+1,n))}),{})),i=Object.assign(i,o.reduce((function(e,n,o){return Object.assign(e,t(g.out,o+1,n))}),{})),s(Z.pushPorts(i))}}),[s,e,c.pos.x,c.pos.y]),Object(r.useEffect)((function(){if(h.current&&o-1===e&&i){var t=h.current,n=t.offsetHeight,r=t.offsetWidth;s(Z.moveNode({nodeId:e,dx:.2*-r,dy:.2*-n}))}}),[]),Object(yt.jsxs)(Bt,{selected:a,ref:h,x:l.x,y:l.y,isSub:c.isSub,onMouseDown:function(t){t.stopPropagation();var n=t.clientX,o=t.clientY;s(Z.select({type:"node",selectId:e})),s(Z.setMouseBlockDragPos({clientX:n,clientY:o}))},onContextMenu:function(t){},onDoubleClick:function(){},children:[Object(yt.jsx)(Et,Object(d.a)({},c)),!c.isSub&&Object(yt.jsxs)(yt.Fragment,{children:[Object(yt.jsx)("div",{onClick:function(){s(Z.toggleSubnodes({id:e}))},children:"toggle sub"}),Object(yt.jsx)("div",{onClick:function(){console.log(22),s(Z.toggleChildren({id:e}))},children:"toggle children"})]}),Object(yt.jsx)(At,{id:e,port:u,type:g.in}),Object(yt.jsx)(At,{id:e,port:u,type:g.out}),Object(yt.jsx)("button",{style:{},onMouseDown:function(t){t.stopPropagation()},children:"X"})]})},Ft=Object(f.d)($,(function(t){return Object.entries(t.drawflow).filter((function(t){var e=Object(u.a)(t,2);e[0];return!1!==e[1].visible})).map((function(t){var e=Object(u.a)(t,1)[0];return Number(e)}))})),Kt=function(){var t=nt(Ft);return Object(yt.jsx)(yt.Fragment,{children:t.map((function(t){return Object(yt.jsx)(Ut,{id:t},t)}))})},Gt=function(){var t=nt($),e=t.connections,n=t.ports,o=Object.entries(e).filter((function(t){return Object(u.a)(t,2)[1]})).map((function(t){var e=Object(u.a)(t,1)[0],o=e.split("_").map(Number),i="".concat(o[0],"_out_").concat(o[1]),r="".concat(o[2],"_in_").concat(o[3]);if(!n[i]||!n[r])return null;var c={x:n[i].x,y:n[i].y},a={x:n[r].x,y:n[r].y},s=b.createCurvature(c,a);return Object(yt.jsx)(Pt.Path,{svgKey:e,d:s},e)}));return Object(yt.jsx)(yt.Fragment,{children:o})},Jt=jt.b.div(L||(L=Object(l.a)(["\n  position: relative;\n  height: 100%;\n  overflow: hidden;\n  background: #282a36;\n  background-size: 25px 25px;\n  background-image: linear-gradient(to right, #2f323d 1px, transparent 1px),\n    linear-gradient(to bottom, #2f323d 1px, transparent 1px);\n"]))),Rt=jt.b.div(Y||(Y=Object(l.a)(["\n  width: 100%;\n  height: 100%;\n  position: relative;\n"]))),qt=function(){var t=nt($),e=t.config,n=e.canvasTranslate,o=n.x,i=n.y,c=e.zoom,a=t.newPathDirection,s=et();return Object(r.useEffect)((function(){s(bt())}),[s]),Object(yt.jsxs)(Jt,{tabIndex:0,onKeyDownCapture:function(t){"Delete"===t.key&&(s(Z.deletePath()),s(Z.deleteNode())),t.ctrlKey&&"c"===t.key&&s(Z.copyNode()),t.ctrlKey&&"v"===t.key&&s(Z.insertCopiedNode())},onMouseDown:function(t){s(Z.canvasDrag(!0)),s(Z.unSelect())},onMouseUp:function(){return s(Z.canvasMouseUp())},onMouseMove:function(t){var e=t.clientX,n=t.clientY,o=t.movementX,i=t.movementY;s(Z.canvasMouseMove({clientX:e,clientY:n,movementX:o,movementY:i}))},onMouseEnter:function(t){var e=t.clientX,n=t.clientY;s(dt({clientX:e,clientY:n}))},children:[Object(yt.jsx)(wt,{}),Object(yt.jsx)(St,{}),Object(yt.jsxs)(Rt,{className:"drawflow",style:{transform:"translate(".concat(o,"px, ").concat(i,"px) scale(").concat(c.value,")")},children:[Object(yt.jsx)(Kt,{}),Object(yt.jsx)(Gt,{}),a&&Object(yt.jsx)(_t,{})]})]})},Ht=function(t){var e=t.searchWord,n=nt((function(t){return t.templates})),o=et(),i=e.toLowerCase().split(" ").filter((function(t){return t.length>0}));return Object(r.useEffect)((function(){o(pt())}),[o]),Object(yt.jsx)("div",{children:n.map((function(t,e){var n=t.name,r=t.type,c=t.value,a=JSON.stringify(t,null,2);return(i.find((function(t){return a.toLowerCase().includes(t)}))||!i.length)&&Object(yt.jsx)("div",{onMouseDownCapture:function(t){o(ft(1))},children:Object(yt.jsx)("pre",{children:"Type: ".concat(r,"\nValue: ").concat(c+n)})},e)}))})};n(39);var Zt=function(){var t=Object(r.useState)(""),e=Object(u.a)(t,2),n=e[0],o=e[1],i=et();return Object(r.useEffect)((function(){i(Z.align())}),[i]),Object(yt.jsxs)("div",{className:"App",children:[Object(yt.jsxs)("div",{className:"drawflow-node-list",children:[Object(yt.jsx)("div",{className:"drawflow-node-list-search",children:Object(yt.jsx)("input",{type:"text",placeholder:"Search templates",onChange:function(t){o(t.target.value)}})}),Object(yt.jsx)("div",{className:"drawflow-node-list-flex",children:Object(yt.jsx)(Ht,{searchWord:n})})]}),Object(yt.jsxs)("div",{className:"flow",children:[Object(yt.jsxs)("div",{children:[Object(yt.jsx)("button",{onClick:function(){return i(bt())},children:"Fetch flow version"}),Object(yt.jsx)("button",{onClick:function(){return i(lt(0))},children:"Version 1"}),Object(yt.jsx)("button",{onClick:function(){return i(lt(1))},children:"Version 2"}),Object(yt.jsx)("button",{onClick:function(){return i(lt(2))},children:"Version 3"}),Object(yt.jsx)("button",{onClick:function(){return i(Z.align())},children:"Align"})]}),Object(yt.jsx)(qt,{})]})]})};s.a.render(Object(yt.jsx)(c.a.StrictMode,{children:Object(yt.jsx)(tt.a,{store:gt,children:Object(yt.jsx)(Zt,{})})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.3e179329.chunk.js.map